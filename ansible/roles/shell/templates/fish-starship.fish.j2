# Created by Ansible for Fish shell with Starship
# Fish Configuration by Shanmeistro - Starship Edition
# This configuration is optimized for Fish shell with Starship prompt

# Ensure you have a Nerd Font installed and configured in your terminal
# Recommended: {{ recommended_fonts | join(', ') }} Nerd Fonts

# ----------------------------------------------------------------------
# Fish Configuration
# ----------------------------------------------------------------------

# Disable the default fish greeting
set -U fish_greeting

# Set default editor
set -gx EDITOR vim
set -gx VISUAL vim

# Add local bin to PATH if it exists
if test -d {{ local_bin_dir }}
    set -gx PATH {{ local_bin_dir }} $PATH
end

# ----------------------------------------------------------------------
# SSH Agent Configuration
# ----------------------------------------------------------------------
if not set -q SSH_AUTH_SOCK
    if pgrep -u (whoami) ssh-agent > /dev/null
        set -gx SSH_AUTH_SOCK (find /tmp/ssh-* -user (whoami) -name 'agent.*' 2>/dev/null | head -n 1)
        if test -z "$SSH_AUTH_SOCK"
            eval (ssh-agent -c)
        end
    else
        eval (ssh-agent -c)
    end
end

# Add SSH keys if none are loaded
ssh-add -l > /dev/null 2>&1
if test $status -ne 0
    # Add your SSH keys here
    test -f ~/.ssh/id_rsa && ssh-add ~/.ssh/id_rsa 2>/dev/null
    test -f ~/.ssh/id_rsa_ado && ssh-add ~/.ssh/id_rsa_ado 2>/dev/null
    test -f ~/.ssh/id_rsa_gitlab && ssh-add ~/.ssh/id_rsa_gitlab 2>/dev/null
    test -f ~/.ssh/id_ed25519 && ssh-add ~/.ssh/id_ed25519 2>/dev/null
end

# ----------------------------------------------------------------------
# Aliases
# ----------------------------------------------------------------------

# Common aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

# System
alias update='sudo apt update && sudo apt upgrade -y'

# Git aliases
alias ga='git add'
alias gc='git commit -m'
alias gp='git push'
alias gl='git pull'
alias gst='git status'
alias gd='git diff'
alias gco='git checkout'
alias gb='git branch'

# Docker aliases
alias dcup='docker-compose up -d'
alias dcdown='docker-compose down'
alias dclogs='docker-compose logs -f'
alias dcbash='docker-compose exec'

# Kubernetes aliases
alias k='kubectl'
alias kget='kubectl get'
alias kdesc='kubectl describe'
alias klogs='kubectl logs -f'
alias kctx='kubectl config use-context'

# Navigation aliases
alias repos='cd ~/repos'
alias personal='cd ~/repos/personal'
alias learning='cd ~/repos/learning'
alias pro='cd ~/repos/professional'

# Safety aliases
alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# ----------------------------------------------------------------------
# Fish-specific configurations
# ----------------------------------------------------------------------

# Enable Vi mode (optional)
# fish_vi_key_bindings

# Set fish colors (optional customization)
set -U fish_color_normal normal
set -U fish_color_command blue
set -U fish_color_quote green
set -U fish_color_redirection cyan
set -U fish_color_end magenta
set -U fish_color_error red
set -U fish_color_param normal
set -U fish_color_comment yellow
set -U fish_color_match cyan
set -U fish_color_selection white --bold --background=brblack
set -U fish_color_search_match bryellow --background=brblack
set -U fish_color_history_current --bold
set -U fish_color_operator cyan
set -U fish_color_escape brcyan
set -U fish_color_cwd green
set -U fish_color_cwd_root red
set -U fish_color_valid_path --underline
set -U fish_color_autosuggestion 555 brblack
set -U fish_color_user brgreen
set -U fish_color_host normal
set -U fish_color_cancel -r

# ----------------------------------------------------------------------
# Starship Prompt Initialization (MUST BE LAST)
# ----------------------------------------------------------------------
starship init fish | source