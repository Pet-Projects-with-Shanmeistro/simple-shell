# Remap prefix from 'C-b' to 'C-a' - easier to reach
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Reload tmux configuration
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# ===== TIMING & UX IMPROVEMENTS =====
set -g repeat-time 8000 # (default is 8000ms or 8 seconds)
# 5 seconds - Good balance for most users (default is 5000ms)
# 10 seconds - More generous, good for complex resize operations (default is 10000ms)
# 15 seconds - Very generous, good if you're often interrupted (default is 15000ms)
# 7.5 seconds - optimal balance (default is 7500ms)
set -g display-time 2000
set -sg escape-time 10
set -g history-limit 50000

# ===== COPY MODE SETUP =====
setw -g mode-keys vi
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'r' send -X rectangle-toggle

# ===== CROSS-PLATFORM COPY/PASTE =====
if-shell '[ -n "$WSL_DISTRO_NAME" ] || [ -n "$WSLENV" ]' {
    bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "clip.exe"
    bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "clip.exe"
    bind C-v run-shell "powershell.exe -c Get-Clipboard | tmux load-buffer - && tmux paste-buffer"
} {
    if-shell "command -v pbcopy" {
        bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"
        bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
        bind C-v run-shell "pbpaste | tmux load-buffer - && tmux paste-buffer"
    } {
        bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -sel clip"
        bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -sel clip"
        bind C-v run-shell "xclip -o -sel clip | tmux load-buffer - && tmux paste-buffer"
    }
}

# ===== MOUSE SCROLLING =====
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M

# ===== CONTEXT MENU =====
bind m display-menu -T "Actions" \
    "New Window" w "new-window" \
    "Split â†’" h "split-window -h" \
    "Split â†“" v "split-window -v" \
    "Kill Pane" x "confirm-before kill-pane" \
    "Copy Mode" c "copy-mode" \
    "Paste" p "paste-buffer"

# ===== OPTIONAL: CONFIRMATIONS =====
bind x confirm-before -p "Kill pane? (y/n)" kill-pane
bind X confirm-before -p "Kill window? (y/n)" kill-window

# ===== EASY PANE SWITCHING =====
# Switch panes with just prefix + hjkl (vim-style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Quick pane switching without prefix (Ctrl + hjkl)
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# Last pane toggle (like Alt+Tab for panes)
bind Tab last-pane

# ===== EASY WINDOW SWITCHING =====
# Switch windows with prefix + number (you already have this by default)
# But add these for easier access:

# Previous/Next window with prefix + arrow left/right
bind Left previous-window
bind Right next-window

# Previous/Next window without prefix (Shift + arrow)
bind -n S-Left previous-window
bind -n S-Right next-window

# Last window toggle (like Alt+Tab for windows)
bind ` last-window

# Quick window switching with Alt + number (no prefix needed)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# ===== SUPER QUICK NAVIGATION =====
# Cycle through panes quickly (no prefix needed)
bind -n M-o select-pane -t :.+

# Swap current pane with next/previous
bind > swap-pane -D
bind < swap-pane -U

# Move current window left/right in window list
bind -r S-Left swap-window -t -1\; select-window -t -1
bind -r S-Right swap-window -t +1\; select-window -t +1

